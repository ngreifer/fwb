[{"path":"https://ngreifer.github.io/fwb/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Noah Greifer. Author, maintainer.","code":""},{"path":"https://ngreifer.github.io/fwb/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Greifer N (2022). fwb: Fractional Weighted Bootstrap. https://github.com/ngreifer/fwb, https://ngreifer.github.io/fwb/.","code":"@Manual{,   title = {fwb: Fractional Weighted Bootstrap},   author = {Noah Greifer},   year = {2022},   note = {https://github.com/ngreifer/fwb, https://ngreifer.github.io/fwb/}, }"},{"path":"https://ngreifer.github.io/fwb/index.html","id":"fwb-fractional-weighted-bootstrap","dir":"","previous_headings":"","what":"Fractional Weighted Bootstrap","title":"Fractional Weighted Bootstrap","text":"fwb implements fractional weighted bootstrap (FWB) , also known Bayesian bootstrap, following treatment Xu et al. (2020). FWB involves generating sets weights uniform Dirichlet distribution used estimating statistics interest, yields posterior distribution can interpreted way traditional (resampling0based) bootstrap distribution can . primary function fwb(), essentially drop-boot::boot() takes dataset function applies function dataset randomly generated set case weights. Also included fwb.ci(), drop-boot::boot.ci() computing various kinds confidence intervals (e.g., percentile, normal, bias-corrected percentile, etc.), vcovFWB(), drop-sandwich::vcovBS() computing coefficient covariance matrix regression model using FWB. Check fwb website!","code":""},{"path":"https://ngreifer.github.io/fwb/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Fractional Weighted Bootstrap","text":"can install development version fwb GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"ngreifer/fwb\")"},{"path":"https://ngreifer.github.io/fwb/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Fractional Weighted Bootstrap","text":"examples use fwb.","code":"library(\"fwb\")"},{"path":"https://ngreifer.github.io/fwb/index.html","id":"bearing-cage-field-failure-weibull-analysis-from-xu-et-al-2000","dir":"","previous_headings":"Examples","what":"Bearing cage field failure Weibull analysis from Xu et al. (2000)","title":"Fractional Weighted Bootstrap","text":"example involves performing Weibull analysis estimate β (shape) parameter Weibull distribution characterizing time failure set aircraft engines. Among 1703 engines, 6 failures 1697 right-censored observations. traditional (resampling-based) bootstrap fail bootstrap replication omitted 6 failures, failures retained using FWB, makes particularly effective analysis.","code":"data(\"bearingcage\", package = \"fwb\")  # Function to compute the scale (eta) and shape (beta) parameters # from weighted data weibull_est <- function(data, w) {   fit <- survival::survreg(survival::Surv(hours, failure) ~ 1,                            data = data, weights = w,                            dist = \"weibull\")    c(eta = unname(exp(coef(fit))), beta = 1/fit$scale) }  # 1999 bootstrap replications; more is always better fwb_est <- fwb(bearingcage, statistic = weibull_est,                 R = 1999, verbose = FALSE) fwb_est #> FRACTIONAL WEIGHTED BOOTSTRAP #>  #> Call: #> fwb(data = bearingcage, statistic = weibull_est, R = 1999, verbose = FALSE) #>  #> Bootstrap Statistics : #>         original         bias   std. error #> t1* 11792.178173 6528.5275456 21092.241147 #> t2*     2.035319    0.2540133     0.894168  # Bias-corrected percentile confidence interval summary(fwb_est, ci.type = \"bc\") #>      Estimate Std. Error CI 2.5 % CI 97.5 % #> eta  1.18e+04   2.11e+04 3.18e+03  7.21e+04 #> beta 2.04e+00   8.94e-01 1.23e+00  4.58e+00  # Plot the bootstrap distribution plot(fwb_est, index = \"beta\", qdist = \"chisq\")"},{"path":"https://ngreifer.github.io/fwb/index.html","id":"infertility-logistic-regression-analysis-using-infert-dataset","dir":"","previous_headings":"Examples","what":"Infertility logistic regression analysis using infert dataset","title":"Fractional Weighted Bootstrap","text":"example demonstrates using vcovFWB() estimate standard errors effect spontaneous induced abortions infertility analyzed Trichopoulos et al. (1976). Patients organized matched sets 3 patients . use fixed effects logistic regression adjust matched set membership (ignoring potential bias approach sake example). traditional bootstrap fails many matched sets fully omit either cases non-cases, leading perfect prediction failure model converge, yielding invalid estimates. units retained using FWB, model always converges estimates reasonable. can also perform cluster-robust inference bootstrapping strata. (Note case traditional bootstrap fine, FWB still accurate.) Let’s look -depth results traditional fractional weighted bootstrap comparing output fwb() boot::boot(). Already bias standard errors indicate problems traditional bootstrap. Let’s plot histograms estimates see failure :   clear estimates traditional bootstrap pathological, whereas estimates FWB reasonable. non-normality FWB distributions also suggests usual Wald-style confidence intervals may accurate, percentile interval computed instead.","code":"data(\"infert\")  fit <- glm(case ~ spontaneous + induced + factor(stratum),            data = infert, family = quasibinomial())  library(\"lmtest\")  # The traditional bootstrap fails coeftest(fit, vcov = sandwich::vcovBS)[1:3,] #>              Estimate   Std. Error       z value  Pr(>|z|) #> (Intercept) -6.904101 4.472792e+19 -1.543577e-19 1.0000000 #> spontaneous  3.230286 3.167708e+06  1.019755e-06 0.9999992 #> induced      2.190303 3.102472e+06  7.059862e-07 0.9999994  # The fractional weighted bootstrap succeeds coeftest(fit, vcov = vcovFWB)[1:3,] #>              Estimate Std. Error   z value     Pr(>|z|) #> (Intercept) -6.904101  1.8276925 -3.777496 1.584130e-04 #> spontaneous  3.230286  0.7277096  4.438976 9.038774e-06 #> induced      2.190303  0.6857453  3.194047 1.402932e-03 # Including stratum membership as a clustering variable coeftest(fit, vcov = vcovFWB, cluster = ~stratum)[1:3,] #>              Estimate Std. Error   z value     Pr(>|z|) #> (Intercept) -6.904101  1.6495855 -4.185355 2.847204e-05 #> spontaneous  3.230286  0.7628024  4.234761 2.287951e-05 #> induced      2.190303  0.6682861  3.277493 1.047335e-03 fit_fun <- function(data, w) {   fit <- glm(case ~ spontaneous + induced + factor(stratum),            data = data, weights = w, family = quasibinomial())   coef(fit)[1:3] }  boot_est <- boot::boot(infert, fit_fun, R = 999, stype = \"f\") boot_est #>  #> ORDINARY NONPARAMETRIC BOOTSTRAP #>  #>  #> Call: #> boot::boot(data = infert, statistic = fit_fun, R = 999, stype = \"f\") #>  #>  #> Bootstrap Statistics : #>      original        bias     std. error #> t1* -6.904101 -2.385907e+19 5.368296e+20 #> t2*  3.230286  4.072669e+13 2.952474e+14 #> t3*  2.190303  2.730053e+13 2.009225e+14  fwb_est <- fwb(infert, fit_fun, R = 999, verbose = FALSE) fwb_est #> FRACTIONAL WEIGHTED BOOTSTRAP #>  #> Call: #> fwb(data = infert, statistic = fit_fun, R = 999, verbose = FALSE) #>  #> Bootstrap Statistics : #>      original       bias std. error #> t1* -6.904101 -1.6181838  1.8461133 #> t2*  3.230286  0.6611793  0.7424671 #> t3*  2.190303  0.5056567  0.6588132 plot(boot_est, index = 2) plot(fwb_est, index = 2)"},{"path":"https://ngreifer.github.io/fwb/index.html","id":"when-to-use-the-fractional-weighted-bootstrap","dir":"","previous_headings":"","what":"When to use the fractional weighted bootstrap","title":"Fractional Weighted Bootstrap","text":"FWB uniformly reliable traditional bootstrap weighted statistic can computed (though doesn’t mean bootstrap always valid). simple cases, methods yield results. pathological examples like , FWB dramatically outperforms traditional bootstrap. true running regression models sparse categorical variables either outcome among predictors, example, estimating fixed effects binary outcome rare. However, important know weighted statistic can computed; example, computing weighted median always straightforward, making traditional bootstrap potentially useful computing . Still, though, FWB deserves place analyst’s toolbox.","code":""},{"path":"https://ngreifer.github.io/fwb/index.html","id":"related-packages","dir":"","previous_headings":"","what":"Related packages","title":"Fractional Weighted Bootstrap","text":"boot, provides traditional bootstrap, including interface accepted frequency weights compute weighted statistics, used bayesboot, also provides functionality Bayesian bootstrap explicitly Bayesian fashion returned objects less consistent boot","code":""},{"path":"https://ngreifer.github.io/fwb/index.html","id":"author","dir":"","previous_headings":"","what":"Author","title":"Fractional Weighted Bootstrap","text":"Noah Greifer (noah.greifer@gmail.com)","code":""},{"path":"https://ngreifer.github.io/fwb/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Fractional Weighted Bootstrap","text":"Trichopoulos, D., Handanos, N., Danezis, J., Kalandidi, . Kalapothaki, V. (1976), Induced Abortion Secondary Infertility. BJOG: International Journal Obstetrics & Gynaecology, 83, 645-650. https://doi.org/10.1111/j.1471-0528.1976.tb00904.x Xu, L., Gotwalt, C., Hong, Y., King, C. B., & Meeker, W. Q. (2020). Applications Fractional-Random-Weight Bootstrap. American Statistician, 74(4), 345–358. https://doi.org/10.1080/00031305.2020.1731599","code":""},{"path":"https://ngreifer.github.io/fwb/reference/bearingcage.html","id":null,"dir":"Reference","previous_headings":"","what":"Bearing Cage field failure data — bearingcage","title":"Bearing Cage field failure data — bearingcage","text":"data consist 1703 aircraft engines put service time. 6 failures 1697 right-censored observations. data originally given Abernethy et al. (1983) reanalyzed Meeker Escobar (1998, chap.8). dataset used specifically comes Xu et al. (2020) used Weibull analysis failure times.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/bearingcage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bearing Cage field failure data — bearingcage","text":"","code":"data(\"bearingcage\")"},{"path":"https://ngreifer.github.io/fwb/reference/bearingcage.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Bearing Cage field failure data — bearingcage","text":"data frame 1703 rows 2 variables: hours integer; number hours failure censoring failure logical; whether failure occured","code":""},{"path":"https://ngreifer.github.io/fwb/reference/bearingcage.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bearing Cage field failure data — bearingcage","text":"Abernethy, R. B., Breneman, J. E., Medlin, C. H., Reinman, G. L. (1983), \"Weibull Analysis Handbook,\" Technical Report, Air Force Wright Aeronautical Laboratories, available https://apps.dtic.mil/sti/citations/ADA143100. Meeker, W. Q., Escobar, L. . (1998), Statistical Methods Reliability Data, New York: Wiley. Xu, L., Gotwalt, C., Hong, Y., King, C. B., & Meeker, W. Q. (2020). Applications Fractional-Random-Weight Bootstrap. American Statistician, 74(4), 345–358. doi:10.1080/00031305.2020.1731599","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb-package.html","id":null,"dir":"Reference","previous_headings":"","what":"fwb: Fractional Weighted Bootstrap — fwb-package","title":"fwb: Fractional Weighted Bootstrap — fwb-package","text":"implementation fractional weighted bootstrap used drop-functions 'boot' package. fractional weighted bootstrap (also known Bayesian bootstrap) involves drawing weights randomly applied data rather resampling units data. See Xu et al. (2020) doi:10.1080/00031305.2020.1731599  details.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"fwb: Fractional Weighted Bootstrap — fwb-package","text":"Xu, L., Gotwalt, C., Hong, Y., King, C. B., & Meeker, W. Q. (2020). Applications Fractional-Random-Weight Bootstrap. American Statistician, 74(4), 345–358. doi:10.1080/00031305.2020.1731599","code":""},{"path":[]},{"path":"https://ngreifer.github.io/fwb/reference/fwb-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fwb: Fractional Weighted Bootstrap — fwb-package","text":"Maintainer: Noah Greifer noah.greifer@gmail.com (ORCID)","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.ci.html","id":null,"dir":"Reference","previous_headings":"","what":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","title":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","text":"fwb.ci() generates several types equi-tailed two-sided nonparametric confidence intervals. include normal approximation, basic bootstrap interval, percentile bootstrap interval, bias-corrected percentile bootstrap interval, bias-correct accelerated (BCa) bootstrap interval.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.ci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","text":"","code":"fwb.ci(   fwb.out,   conf = 0.95,   type = \"bc\",   index = 1L,   h = base::identity,   hinv = base::identity,   ... )  # S3 method for fwbci print(x, hinv = NULL, ...)"},{"path":"https://ngreifer.github.io/fwb/reference/fwb.ci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","text":"fwb.fwb object; output call fwb(). conf desired confidence level. Default .95 95% confidence intervals. type type confidence interval desired. Allowable options include \"norm\" (normal approximation), \"basic\" (basic interval), \"perc\" (percentile interval), \"bc\" (bias-correct percentile interval), \"bca\" (BCa interval). one allowed. Can also \"\" request . BCa intervals require number bootstrap replications larger sample size. index index position quantity interest fwb.$t0 one specified fwb(). one value allowed time. default first statistic used. h function defining transformation. intervals calculated scale h(t) inverse function hinv applied resulting intervals. must function one variable vector argument, must return vector length. Default identity function. hinv function, like h, returns inverse h. used transform intervals calculated scale h(t) back original scale. default identity function. h supplied hinv , intervals returned transformed scale. ... ignored x fwbci object; output fo call fwb.ci().","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.ci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","text":"fwbci object, inherits bootci following components: R number bootstrap replications original call fwb(). t0 observed value statistic scale intervals (.e., afetr applying h hinv. call call fwb.ci(). additional components named confidence interval type requested. \"norm\", matrix one row containing confidence level two confidence interval limits. others, matrix one row containing confidence level, indices two order statistics used calculations, confidence interval limits.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.ci.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","text":"fwb.ci() functions similarly boot::boot.ci() takes bootstrapped object computes confidence intervals. interface bit old-fashioned, designed mimic boot.ci(). modern interface, see summary.fwb(). bootstrap intervals defined follows, \\(\\alpha =\\) 1 - conf, \\(t_0\\) estimate original sample, \\(\\hat{t}\\) average bootstrap estimates, \\(s_t\\) standard deviation bootstrap estimates, \\(\\t^{()}\\) set ordered estimates \\(\\) corresponding quantile, \\(z_\\frac{\\alpha}{2}\\) \\(z_{1-\\frac{\\alpha}{2}}\\) upper lower critical \\(z\\) scores. \"norm\" (normal approximation): \\([2t_0 - \\hat{t} + s_t z_\\frac{\\alpha}{2}, 2t_0 - \\hat{t} + s_t z_{1-\\frac{\\alpha}{2}}]\\) involves subtracting \"bias\" (\\(\\hat{t} - t_0\\)) estimate \\(t_0\\) using standard Wald-type confidence interval. method valid statistic normally distributed. \"basic\": \\([2t_0 - t^{(1-\\frac{\\alpha}{2})}, 2t_0 - t^{(\\frac{\\alpha}{2})}]\\) \"perc\" (percentile confidence interval): \\([t^{(\\frac{\\alpha}{2})}, t^{(1-\\frac{\\alpha}{2})}]\\) \"bc\" (bias-corrected percentile confidence interval): \\([t^{(l)}, t^{(u)}]\\) \\(l = \\Phi\\left(2z_0 + z_\\frac{\\alpha}{2}\\right)\\), \\(u = \\Phi\\left(2z_0 + z_{1-\\frac{\\alpha}{2}}\\right)\\), \\(\\Phi(.)\\) normal cumulative density function (.e., pnorm()) \\(z_0 = \\Phi^{-1}(q)\\) \\(q\\) proportion bootstrap estimates less original estimate \\(t_0\\). similar percentile confidence interval changes specific quantiles bootstrap estimates use, correcting bias original estimate. described Xu et al. (2020). \\(t^0\\) median bootstrap distribution, \"perc\" \"bc\" intervals coincide. \"bca\" (bias-corrected accelerated confidence interval): \\([t^{(l)}, t^{(u)}]\\) \\(l = \\Phi\\left(z_0 + \\frac{z_0 + z_\\frac{\\alpha}{2}}{1-(z_0+z_\\frac{\\alpha}{2})}\\right)\\), \\(u = \\Phi\\left(z_0 + \\frac{z_0 + z_{1-\\frac{\\alpha}{2}}}{1-(z_0+z_{1-\\frac{\\alpha}{2}})}\\right)\\), using definitions , additional acceleration parameter \\(\\), \\(= \\frac{1}{6}\\frac{\\sum{L^3}}{(\\sum{L^2})^{3/2}}\\). \\(L\\) empirical influence value unit, computed using regression method described boot::empinf(). acceleration parameter corrects bias skewness statistic. can used clusters absent number bootstrap replications larger sample size. \\(=0\\), \"bca\" \"bc\" intervals coincide. Interpolation normal quantile scale used non-integer order statistic required, boot::boot.ci(). Note unlike boot::boot.ci(), studentized confidence intervals (type = \"stud\") allowed.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.ci.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","text":"print(fwbci): Print bootstrap confidence interval","code":""},{"path":[]},{"path":"https://ngreifer.github.io/fwb/reference/fwb.ci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fractional Weighted Bootstrap Confidence Intervals — fwb.ci","text":"","code":"data(\"infert\")  fit_fun <- function(data, w) {   fit <- glm(case ~ spontaneous + induced, data = data,              family = \"quasibinomial\", weights = w)   coef(fit) }  fwb_out <- fwb(infert, fit_fun, R = 199, verbose = FALSE)  # Bias corrected percentile interval bcci <- fwb.ci(fwb_out, index = \"spontaneous\", type = \"bc\") bcci #> BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS #> Based on 199 bootstrap replicates #>  #> CALL :  #> fwb.ci(fwb.out = fwb_out, type = \"bc\", index = \"spontaneous\") #>  #> Intervals :  #> Level BC Percentile   #> 95%   ( 0.789,  1.588 )   #> Calculations and Intervals on Original Scale #> Some bias-corrected percentile intervals may be unstable  # Using `get_ci()` to extract confidence limits  get_ci(bcci) #> $bc #>         L         U  #> 0.7894637 1.5875045  #>  #> attr(,\"conf\") #> [1] 0.95  # Interval calculated on original (log odds) scale, # then transformed by exponentiation to be on OR fwb.ci(fwb_out, index = \"induced\", type = \"norm\",        hinv = exp) #> BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS #> Based on 199 bootstrap replicates #>  #> CALL :  #> fwb.ci(fwb.out = fwb_out, type = \"norm\", index = \"induced\", hinv = exp) #>  #> Intervals :  #> Level       Normal    #> 95%   ( 1.037,  2.224 )   #> Calculations on Original Scale  but Intervals Transformed"},{"path":"https://ngreifer.github.io/fwb/reference/fwb.html","id":null,"dir":"Reference","previous_headings":"","what":"Fractional Weighted Bootstrap — fwb","title":"Fractional Weighted Bootstrap — fwb","text":"fwb() implements fractional (random) weighted bootstrap, also known Bayesian bootstrap. Rather resampling units include bootstrap samples, weights drawn applied weighted estimator.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fractional Weighted Bootstrap — fwb","text":"","code":"fwb(   data,   statistic,   R = 999,   cluster = NULL,   simple = FALSE,   verbose = TRUE,   cl = NULL,   ... )  # S3 method for fwb print(x, digits = getOption(\"digits\"), index = 1L:ncol(x$t), ...)"},{"path":"https://ngreifer.github.io/fwb/reference/fwb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fractional Weighted Bootstrap — fwb","text":"data dataset used compute statistic statistic function, , applied data, returns vector containing statistic(s) interest. function take least two arguments; first argument data accept dataset second argument w accept vector weights. arguments can passed statistic ... argument. R number bootstrap replicates. Default 999 always better. percentile bootstrap confidence interval exact, can beneficial use one less multiple 100. cluster optional; vector containing cluster membership. supplied, run cluster bootstrap. See Details. Evaluated first data global environment. simple logical; TRUE, weights computed --fly bootstrap replication rather . can save memory cost speed. verbose logical; whether display progress bar. cl cluster object created parallel::makeCluster(), integer indicate number child-processes (integer values ignored Windows) parallel evaluations. See pbapply::pblapply() details. NULL, parallelization take place. ... arguments passed statistic. x fwb object; output call fwb(). digits number significant digits print index index indices position quantity interest x$t0 one specified fwb(). Default print quantities.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fractional Weighted Bootstrap — fwb","text":"fwb object, also inherits boot, following components: t0 observed value statistic applied data uniform weights. t matrix R rows, bootstrap replicate result calling statistic. R value R passed fwb(). data data passed fwb(). seed value .Random.seed just prior generating weights (first call statistic uniform weights). statistic function statistic passed fwb(). call original call fwb(). cluster vector passed cluster, .","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fractional Weighted Bootstrap — fwb","text":"fwb() implements fractional weighted bootstrap meant function drop-boot::boot(., stype = \"f\") (.e., usual bootstrap frequency weights representing number times unit drawn). bootstrap replication, weights sampled independent exponential distributions rate parameter 1 normalized mean 1, equivalent drawing weights Dirichlet distribution. function supplied statistic must incorporate weights compute weighted statistic. example, output regression coefficient, weights supplied w argument statistic supplied weights argument lm(). weights used time frequency weights , since meant function like frequency weights (, case traditional bootstrap, integers). Unfortunately, way fwb() know whether using weights correctly, care taken ensure weights correctly incorporated estimator. fitting binomial regression models (e.g., logistic) using glm(), may useful change family \"quasi\" variety (e.g., quasibinomial()) avoid spurious warning \"non-integer #successes\". cluster bootstrap can requested supplying vector cluster membership cluster. Rather generating weight unit, weight generated cluster applied units cluster. Ideally, statistic involve random element, else straightforward replicate bootstrap results using seed included output object. Setting seed using set.seed() always advised. print() method displays value statistics, bias (difference statistic mean bootstrap distribution), standard error (standard deviation fo bootstrap distribution).","code":""},{"path":"https://ngreifer.github.io/fwb/reference/fwb.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"Fractional Weighted Bootstrap — fwb","text":"print(fwb): Print fwb object","code":""},{"path":[]},{"path":"https://ngreifer.github.io/fwb/reference/fwb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fractional Weighted Bootstrap — fwb","text":"","code":"# Performing a Weibull analysis of the Bearing Cage # failure data as done in Xu et al. (2020) data(\"bearingcage\")  weibull_est <- function(data, w) {   fit <- survival::survreg(survival::Surv(hours, failure) ~ 1,                            data = data, weights = w,                            dist = \"weibull\")    c(eta = unname(exp(coef(fit))), beta = 1/fit$scale) }  boot_est <- fwb(bearingcage, statistic = weibull_est,                 R = 199, verbose = FALSE) boot_est #> FRACTIONAL WEIGHTED BOOTSTRAP #>  #> Call: #> fwb(data = bearingcage, statistic = weibull_est, R = 199, verbose = FALSE) #>  #> Bootstrap Statistics : #>         original         bias   std. error #> t1* 11792.178173 8090.3788582 21221.212124 #> t2*     2.035319    0.2246727     1.028569  #Get standard errors and CIs; uses bias-corrected #percentile CI by default summary(boot_est, ci.type = \"bc\") #>      Estimate Std. Error CI 2.5 % CI 97.5 % #> eta  11792.18   21221.21  2461.20  54531.00 #> beta     2.04       1.03     1.29      5.39  #Plot statistic distributions plot(boot_est, index = \"beta\", type = \"hist\")"},{"path":"https://ngreifer.github.io/fwb/reference/get_ci.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Confidence Intervals from a bootci Object — get_ci","title":"Extract Confidence Intervals from a bootci Object — get_ci","text":"get_ci() extracts confidence intervals output call boot::boot.ci() fwb.ci() clean way. Normally confidence intervals can bit challenging extract unusual structure object.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/get_ci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Confidence Intervals from a bootci Object — get_ci","text":"","code":"get_ci(x, type = \"all\")"},{"path":"https://ngreifer.github.io/fwb/reference/get_ci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Confidence Intervals from a bootci Object — get_ci","text":"x bootci object; output fo call boot::boot.ci() fwb.ci(). type type confidence intervals extract. available x allowed. given subset types passed type boot.ci() fwb.ci(). default, \"\", extracts confidence intervals x.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/get_ci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Confidence Intervals from a bootci Object — get_ci","text":"list entry confidence interval type; entry numeric vector length 2 names \"L\" \"U\" lower upper interval bounds, respectively. \"conf\" attribute contains confidence level.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/fwb/reference/get_ci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Confidence Intervals from a bootci Object — get_ci","text":"","code":"#See example at help(\"fwb.ci\")"},{"path":"https://ngreifer.github.io/fwb/reference/plot.fwb.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots of the Output of a Fractional Weighted Bootstrap — plot.fwb","title":"Plots of the Output of a Fractional Weighted Bootstrap — plot.fwb","text":"plot.fwb() takes fwb object produces plots bootstrap replicates statistic interest.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/plot.fwb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots of the Output of a Fractional Weighted Bootstrap — plot.fwb","text":"","code":"# S3 method for fwb plot(   x,   index = 1,   qdist = \"norm\",   nclass = NULL,   df,   type = c(\"hist\", \"qq\"),   ... )"},{"path":"https://ngreifer.github.io/fwb/reference/plot.fwb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots of the Output of a Fractional Weighted Bootstrap — plot.fwb","text":"x fwb object; output call fwb(). index index position quantity interest x$t0 one specified fwb(). one value allowed time. default first statistic used. qdist character; Q-Q plot requested (default; see type argument ), distribution Q-Q plot drawn. Allowable options include \"norm\" (normal distribution - default) \"chisq\" (chi-squared distribution). nclass histogram requested (default; see type argument ), number classes used. default integer 10 100 closest ceiling(length(R)/25) R number bootstrap replicates. df qdist \"chisq\", degrees freedom chi-squared distribution used. supplied, degrees freedom estimated using maximum likelihood. type type plot display. Allowable options include \"hist\" histogram bootstrap estimates \"qq\" Q-Q plot estimates distribution supplied qdist. ... ignored.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/plot.fwb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots of the Output of a Fractional Weighted Bootstrap — plot.fwb","text":"x returned invisibly.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/plot.fwb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plots of the Output of a Fractional Weighted Bootstrap — plot.fwb","text":"function can produces two side--side plots: histogram bootstrap replicates Q-Q plot bootstrap replicates theoretical quantiles supplied distribution (normal chi-squared). histogram, vertical dotted line indicates position estimate computed original sample. Q-Q plot, expected line plotted.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/fwb/reference/plot.fwb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plots of the Output of a Fractional Weighted Bootstrap — plot.fwb","text":"","code":"# See examples at help(\"fwb\")"},{"path":"https://ngreifer.github.io/fwb/reference/summary.fwb.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize fwb Output — summary.fwb","title":"Summarize fwb Output — summary.fwb","text":"summary() creates regression summary-like table displays bootstrap estimates, empirical standard errors, confidence intervals, computed using fwb.ci().","code":""},{"path":"https://ngreifer.github.io/fwb/reference/summary.fwb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize fwb Output — summary.fwb","text":"","code":"# S3 method for fwb summary(   object,   conf = 0.95,   ci.type = \"bc\",   p.value = FALSE,   index = 1L:ncol(object$t),   ... )"},{"path":"https://ngreifer.github.io/fwb/reference/summary.fwb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize fwb Output — summary.fwb","text":"object fwb object; output call fwb(). conf desired confidence level. Default .95 95% confidence intervals. ci.type type confidence interval desired. Allowable options include \"norm\" (normal approximation), \"basic\" (basic interval), \"perc\" (percentile interval), \"bc\" (bias-correct percentile interval), \"bca\" (bias-corrected accelerated [BCa] interval). one allowed. BCa intervals require number bootstrap replications larger sample size. See fwb.ci() details. default \"bc\". p.value logical; whether display p-values test parameter equal 0. p-value computed using Z-test test statistic computed ratio estimate bootstrap standard error. test valid bootstrap distribution normally distributed around 0 guaranteed agree confidence intervals. Default FALSE. index index indices position quantity interest x$t0 one specified fwb(). Default display quantities. ... ignored.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/summary.fwb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize fwb Output — summary.fwb","text":"summary.fwb object, matrix following columns: Estimate: statistic estimated original sample Std. Error: standard deviation bootstrap estimates CI {L}% CI {U}%, upper lower confidence interval bounds computed using argument ci.type. p.value = TRUE, two additional columns, z value Pr(>|z|) included containing z-statistic p-value computed statistic.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/fwb/reference/summary.fwb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize fwb Output — summary.fwb","text":"","code":"data(\"infert\")  fit_fun <- function(data, w) {   fit <- glm(case ~ spontaneous + induced, data = data,              family = \"quasibinomial\", weights = w)   coef(fit) }  fwb_out <- fwb(infert, fit_fun, R = 199, verbose = FALSE)  # Basic confidence interval for both estimates summary(fwb_out, ci.type = \"basic\") #>             Estimate Std. Error CI 2.5 % CI 97.5 % #> (Intercept)  -1.7079     0.2314  -2.0994   -1.1513 #> spontaneous   1.1972     0.1977   0.7033    1.4888 #> induced       0.4181     0.1966   0.0105    0.8179  # Just for \"induced\" coefficient; p-values requested summary(fwb_out, index = \"induced\", p.value = TRUE) #>         Estimate Std. Error CI 2.5 % CI 97.5 % z value Pr(>|z|)   #> induced   0.4181     0.1966   0.0243    0.8321    2.13    0.033 * #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"},{"path":"https://ngreifer.github.io/fwb/reference/vcovFWB.html","id":null,"dir":"Reference","previous_headings":"","what":"Fractional Weighted Bootstrap Covariance Matrix Estimation — vcovFWB","title":"Fractional Weighted Bootstrap Covariance Matrix Estimation — vcovFWB","text":"vcovFWB() estimates covariance matrix model coefficient estimates using fractional weighted bootstrap. serves drop-stats::vcov() sandwich::vcovBS(). Clustered covariances can requested.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/vcovFWB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fractional Weighted Bootstrap Covariance Matrix Estimation — vcovFWB","text":"","code":"vcovFWB(   x,   cluster = NULL,   R = 999,   start = FALSE,   ...,   fix = FALSE,   use = \"pairwise.complete.obs\",   verbose = FALSE,   cl = NULL )"},{"path":"https://ngreifer.github.io/fwb/reference/vcovFWB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fractional Weighted Bootstrap Covariance Matrix Estimation — vcovFWB","text":"x fitted model object, output call lm() glm(). model object must result function can updated using update() weights argument input non-integer case weights. cluster variable indicating clustering observations,     list (data.frame) thereof, formula specifying     variables fitted model used (see examples).     default (cluster = NULL), either attr(x, \"cluster\") used     () otherwise every observation assumed cluster. R number bootstrap replications. start logical; coef(x) passed start update(x, weights = ...) call? case model x computed numeric iteration, may speed bootstrapping. ... ignored. fix logical; TRUE, covariance matrix fixed positive semi-definite case . use character; specification passed stats::cov() handling missing coefficients/parameters. verbose logical; whether display progress bar. cl cluster object created parallel::makeCluster(), integer indicate number child-processes (integer values ignored Windows) parallel evaluations. See pbapply::pblapply() details. NULL, parallelization take place.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/vcovFWB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fractional Weighted Bootstrap Covariance Matrix Estimation — vcovFWB","text":"matrix containing covariance matrix estimate.","code":""},{"path":"https://ngreifer.github.io/fwb/reference/vcovFWB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fractional Weighted Bootstrap Covariance Matrix Estimation — vcovFWB","text":"vcovFWB() functions like vcov()-like functions, sandwich package, particular, sandwich::vcovBS(), implements traditional bootstrap (bootstrap varieties linear models). Sets weights generated described documentation fwb(), supplied model re-fit using weights. fitted model already weights, multiplied bootstrap weights. lm objects, model re-fit using .lm.fit() speed, , similarly, glm objects re-fit using glm.fit() (whichever fitting method originally used). objects, update() used populate weights re-fit model (assumes fitting function accepts non-integer case weights weights argument). model accepts weights way, fwb() used instead; vcovFWB() inherently limited ability handle possible models. important original model fit using frequency weights (.e., weights allow one row data represent multiple full, identical, individual units). See sandwich::vcovBS() sandwich::vcovCL() information clustering covariance matrices, see fwb() information clusters work fractional weighted bootstrap. clusters specified, cluster given bootstrap weight, members cluster given weight; estimation proceeds normal. default, cluster unspecified, unit considered cluster.","code":""},{"path":[]},{"path":"https://ngreifer.github.io/fwb/reference/vcovFWB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fractional Weighted Bootstrap Covariance Matrix Estimation — vcovFWB","text":"","code":"data(\"infert\") fit <- glm(case ~ spontaneous + induced, data = infert,              family = \"binomial\") lmtest::coeftest(fit, vcov. = vcovFWB) #>  #> z test of coefficients: #>  #>             Estimate Std. Error z value  Pr(>|z|)     #> (Intercept) -1.70786    0.24753 -6.8996 5.215e-12 *** #> spontaneous  1.19721    0.21314  5.6169 1.944e-08 *** #> induced      0.41813    0.20591  2.0307   0.04229 *   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  # Example from help(\"vcovBS\", package = \"sandwich\") data(\"PetersenCL\", package = \"sandwich\") m <- lm(y ~ x, data = PetersenCL)  # Note: this is not to compare performance, just to # demonstrate the syntax cbind(   \"BS\" = sqrt(diag(sandwich::vcovBS(m))),   \"FWB\" = sqrt(diag(vcovFWB(m))),   \"BS-cluster\" = sqrt(diag(sandwich::vcovBS(m, cluster = ~ firm))),   \"FWB-cluster\" = sqrt(diag(vcovFWB(m, cluster = ~ firm))) ) #>                     BS        FWB BS-cluster FWB-cluster #> (Intercept) 0.02628675 0.02855012 0.06525811  0.06960814 #> x           0.02894255 0.02853276 0.05506741  0.05064036"},{"path":"https://ngreifer.github.io/fwb/news/index.html","id":"fwb-010","dir":"Changelog","previous_headings":"","what":"fwb 0.1.0","title":"fwb 0.1.0","text":"First version!","code":""}]
